<!doctype html>
<html>
<head>
<title>TEST CodeMirror</title>
  <link rel="stylesheet" href="packs/Highlight/styles/monokai.css">
  <link rel="stylesheet" href="packs/CodeEditor/lib/codemirror.css">
  <link rel="stylesheet" href="packs/CodeEditor/theme/monokai.css">
  <link rel="stylesheet" href="packs/CodeEditor/theme/neat.css">
  <link rel="stylesheet" href="packs/CodeEditor/addon/scroll/simplescrollbars.css">
  <link rel="stylesheet" href="packs/CodeEditor/addon/display/fullscreen.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="packs/Highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="packs/CodeEditor/lib/codemirror.js"></script>
  <script src="packs/CodeEditor/addon/selection/active-line.js"></script>
  <script src="packs/CodeEditor/addon/edit/matchbrackets.js"></script>
  <script src="packs/CodeEditor/addon/scroll/simplescrollbars.js"></script>
  <script src="packs/CodeEditor/addon/display/fullscreen.js"></script>
  <script src="packs/CodeEditor/addon/display/rulers.js"></script>
  <script src="packs/CodeEditor/mode/javascript/javascript.js"></script>

  <script>
  $(document).ready(function(){
  	$('textarea').each(function(elem) {
  	  var textArea = this;


      var string =
      "//Criando conexão com o robo \n"+
      "var connetion = '192.168.25.194' \n" +
      "//Instanciando a Classe \n"+
      "var sar = new Robo(connetion) \n"+
      "//Passando movimentos para ele \n"+
      "sar.move()";

      textArea.value = string

      var codeMirrorOpts = {
    	  	lineNumbers: true,
          mode: "javascript",
          tabSize: 5,
          lineNumbers: true,
          theme: 'monokai',
          scrollbarStyle: "overlay",
          extraKeys: {
          "F11": function(cm) {
            cm.setOption("fullScreen", !cm.getOption("fullScreen"));
          },
          "Esc": function(cm) {
            if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
          }
        }
  	  }

  	  if ($(textArea).hasClass('html') || $(textArea).hasClass('script')) {
          codeMirrorOpts.mode = {name: 'xml', htmlMode: true}
        } else if ($(textArea).hasClass('js')) {
  	      codeMirrorOpts.matchBrackets = true;
  	  }

  	  var editor = CodeMirror.fromTextArea(textArea, codeMirrorOpts);


      $('#lightTheme').click(function(){
        editor.setOption("theme", 'neat');
      });darkTheme
      $('#darkTheme').click(function(){
        editor.setOption("theme", 'monokai');
      });


      // $(editor.getWrapperElement()).keydown(function(e) {
      //   e.stopPropagation();
      // });

      if ($(textArea).hasClass('runnable')) {
  	    var button = $('<button class="btn run-button">Run!</button>');
  	    button.click(function() {
  	      var code = editor.getValue();
  	      if ($(textArea).hasClass('html')) {
  	        $('#demo').html(code);
  	      } else if ($(textArea).hasClass('script')) {
  	        $('body').append(code);
  	      } else if ($(textArea).hasClass('js')) {
  	        window.eval(code);
            window.onerror =  function(e, url, line){
              alert('tem erro');
            }
  	      }

  	    });
  	    $(this).after(button);
      }
  	});
  });
  </script>
  <style >
  .container-header{
    width: 100%;
    display: flex;
    justify-content: space-between;
    color: rgba(0,0,0,0.9);
    background: var(--branco);
    -webkit-box-shadow: 1px 4px 11px -1px rgba(0,0,0,0.2);
    -moz-box-shadow: 1px 4px 11px -1px rgba(0,0,0,0.2);
    box-shadow: 1px 4px 5px -3px rgba(0,0,0,0.2);
  }
  .title-header{
    display: flex;
    align-items: center;
  }
  .logo-header{
    width: 20%;
  }
  .title-header h1{
    font-size: 1.8rem;
  }
  .config{
    display: flex;
    justify-content: flex-end;
    align-items: center;
    width: 35%;
  }
  .config img {
    cursor: pointer;
    width: 10%;
    margin: .5rem;
  }
  .btn-sair {
    width: 30%!important;
  }
  </style>
</head>
<body>
  <!-- header -->
      <header>
        <div class="container-header">
          <div class="title-header">
            <img class="logo-header" src="img/logo_svg.svg" alt="Logo SAR"></img>
            <h1>SAR - PAINEL CONTROLES </h1>
          </div>
          <div class="config">
            <img src="img/icons/config.svg" class="btn-config" alt="configurações"></img>
              <a href="/sair_grupo">
                <img src="img/icons/exit.svg" class="btn-sair" alt="sair"></img>
              </a>
              <a href="#modalSair" rel="modal:open">
                <img src="img/icons/exit.svg" class="btn-sair" alt="sair"></img>
              </a>
          </div>
        </div>
      </header>

  <div style="width: 100%">
    <div id="terminal-CodeEditor" class="content C-terminal">
        <!--CODE EDITOR - REFERENCES CODEMIRROR-->
        <div id="container-code" class="Code-editor">
          <div class="titles-section">
            <h1>Execute seus Códigos:</h1>
            <i id="btn-voltar_salas" class="material-icons">navigate_before</i>
          </div>
          <textarea id="codeeditor"class="runnable js"></textarea>
        </div>
      </div>
    <p>aperte F11 para imersão !</p>
    <p>OBS: DENTRO DO CodeEditor!</p>
  </div>
  <button id="lightTheme">Thema Claro</button>
  <button id="darkTheme">Thema Escuro</button>

  <button type="button" onclick="loadDoc()">Change Content</button>


    <p id="demo">
i
    </p>
  <script src="sar.js"></script>
  <script type="text/javascript">
    function loadDoc() {

      var xhttp = new XMLHttpRequest();

      xhttp.open("GET", "http://192.168.25.194/comando_robo/FRENTE/", true);
      xhttp.send();
      setInterval(test2, 2000)
    }
    function test2(){
      var xhttp = new XMLHttpRequest();

      xhttp.open("GET", "http://192.168.25.194/comando_robo/STOP/", true);
      xhttp.send();
    }
  </script>
</body>
</html>
